# Passo a Passo: Configuração do Projeto Next.js + Mantine

Este documento descreve os passos para criar um novo projeto Next.js (com App Router e diretório `src/`) e configurá-lo com a biblioteca de componentes Mantine.

1.  **Criar o Projeto Next.js:**
    *   Abra o terminal na pasta onde deseja criar o projeto.
    *   Execute o comando:
        ```bash
        npx create-next-app@latest . --js --eslint --app
        ```
    *   Durante a instalação, responda às perguntas:
        *   Use Tailwind CSS? **No**
        *   Use `src/` directory? **Yes**
        *   Use Turbopack? (escolha sua preferência, ex: **Yes**)
        *   Customize import alias? (escolha sua preferência, ex: **No**)

2.  **Instalar Dependências do Mantine:**
    *   Navegue até a pasta do projeto, se necessário.
    *   Execute o comando:
        ```bash
        npm install @mantine/hooks @mantine/core @mantine/next
        ```

3.  **Instalar Dependências de Desenvolvimento (PostCSS):**
    *   Execute o comando:
        ```bash
        npm install -D postcss postcss-preset-mantine postcss-simple-vars
        ```

4.  **Criar Arquivo de Configuração PostCSS (`postcss.config.mjs`):**
    *   Crie um arquivo chamado `postcss.config.mjs` na raiz do projeto com o seguinte conteúdo:
        ```javascript
        export default {
          plugins: {
            'postcss-preset-mantine': {},
            'postcss-simple-vars': {
              variables: {
                'mantine-breakpoint-xs': '36em',
                'mantine-breakpoint-sm': '48em',
                'mantine-breakpoint-md': '62em',
                'mantine-breakpoint-lg': '75em',
                'mantine-breakpoint-xl': '88em',
              },
            },
          },
        };
        ```

5.  **Configurar o Layout Global (`src/app/layout.js`):**
    *   Abra o arquivo `src/app/layout.js`.
    *   Modifique o arquivo para incluir o `MantineProvider`, `ColorSchemeScript` e importar os estilos do Mantine **antes** dos estilos globais. Adicione também `suppressHydrationWarning` à tag `<html>`:
        ```javascript
        import { Geist, Geist_Mono } from "next/font/google";
        // Importe os estilos do Mantine ANTES dos globais
        import '@mantine/core/styles.css';
        import "./globals.css";
        import { ColorSchemeScript, MantineProvider } from '@mantine/core';

        const geistSans = Geist({
          variable: "--font-geist-sans",
          subsets: ["latin"],
        });

        const geistMono = Geist_Mono({
          variable: "--font-geist-mono",
          subsets: ["latin"],
        });

        export const metadata = {
          title: "Create Next App",
          description: "Generated by create next app",
        };

        export default function RootLayout({ children }) {
          return (
            // Adicione suppressHydrationWarning aqui
            <html lang="en" suppressHydrationWarning>
              <head>
                {/* Adicione defaultColorScheme */}
                <ColorSchemeScript defaultColorScheme="light" />
              </head>
              <body className={`${geistSans.variable} ${geistMono.variable}`}>
                {/* Envolva children com MantineProvider e adicione defaultColorScheme */}
                <MantineProvider defaultColorScheme="light">{children}</MantineProvider>
              </body>
            </html>
          );
        }
        ```

6.  **Limpar Estilos Globais Padrão (`src/app/globals.css`):**
    *   Abra o arquivo `src/app/globals.css`.
    *   Delete todo o conteúdo do arquivo, deixando-o vazio.

7.  **Rodar o Projeto:**
    *   Execute o comando para iniciar o servidor de desenvolvimento:
        ```bash
        npm run dev
        ```

Seu projeto Next.js com Mantine deve estar configurado e rodando sem o erro de hidratação.

## Configuração de Testes (Jest + React Testing Library)

Para adicionar capacidade de testes unitários e de componentes com Jest e React Testing Library, siga estes passos:

1.  **Instalar Dependências de Teste:**
    *   Instale os pacotes necessários como dependências de desenvolvimento:
        ```bash
        npm install --save-dev jest @testing-library/react @testing-library/jest-dom jest-environment-jsdom @testing-library/user-event
        ```
    *   **Nota:** Em alguns casos (como vimos neste projeto), pode ser necessário instalar pacotes individualmente se o comando acima falhar ou não registrar todas as dependências corretamente no `package.json` (ex: `npm install --save-dev jest`, `npm install --save-dev jest-environment-jsdom`, etc.).

2.  **Criar Configuração do Jest (`jest.config.js`):**
    *   Crie um arquivo `jest.config.js` na raiz do projeto.
    *   Este arquivo utiliza a integração `next/jest` para carregar automaticamente as configurações do Next.js (como aliases de módulo, se houver) no ambiente de teste.
    *   Conteúdo base:
        ```javascript
        // jest.config.js
        const nextJest = require('next/jest')

        // Fornece o caminho para o seu aplicativo Next.js para carregar next.config.js e arquivos .env no seu ambiente de teste
        const createJestConfig = nextJest({
          dir: './',
        })

        // Adicione qualquer configuração personalizada a ser passada para o Jest
        /** @type {import('jest').Config} */
        const customJestConfig = {
          // Adiciona mais opções de configuração antes de cada teste ser executado
          setupFilesAfterEnv: ['<rootDir>/jest.setup.js'],
          // Se estiver usando TypeScript com baseUrl definido para o diretório raiz, você precisa do abaixo para que os aliases funcionem
          moduleDirectories: ['node_modules', '<rootDir>/'],
          testEnvironment: 'jest-environment-jsdom',
          // Lida com aliases de módulo (se você os tiver em tsconfig.json ou jsconfig.json)
          // moduleNameMapper: {
          //   '^@/components/(.*)$': '<rootDir>/components/$1',
          //   '^@/pages/(.*)$': '<rootDir>/pages/$1',
          // }
        }

        // createJestConfig é exportado desta forma para garantir que next/jest possa carregar a configuração do Next.js que é assíncrona
        module.exports = createJestConfig(customJestConfig)
        ```

3.  **Criar Arquivo de Setup do Jest (`jest.setup.js`):**
    *   Crie um arquivo `jest.setup.js` na raiz do projeto.
    *   Este arquivo é usado para importar configurações ou "matchers" adicionais antes que os testes rodem. Principalmente, importamos os matchers do `jest-dom` para facilitar as asserções sobre elementos do DOM (ex: `toBeInTheDocument`).
    *   Conteúdo:
        ```javascript
        // jest.setup.js
        // Opcional: configure ou configure um framework de teste antes de cada teste
        // Usado para coisas como carregar matchers específicos do jest-dom
        import '@testing-library/jest-dom';
        ```

4.  **Adicionar Script de Teste ao `package.json`:**
    *   Abra o arquivo `package.json`.
    *   Dentro do objeto `"scripts"`, adicione uma nova entrada para rodar os testes:
        ```json
        "scripts": {
          // ... outros scripts (dev, build, start, lint)
          "test": "npx jest"
        },
        ```
    *   Usamos `npx jest` para garantir que a versão do Jest instalada localmente no projeto seja executada, evitando problemas com instalações globais ou variáveis de ambiente.

5.  **Executar os Testes:**
    *   Com a configuração pronta, você pode executar os testes a qualquer momento usando o comando:
        ```bash
        npm test
        ```
    *   O Jest encontrará automaticamente os arquivos de teste (por padrão, arquivos `*.test.js`, `*.spec.js`, etc.) no projeto. 